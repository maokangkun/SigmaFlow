{"version":3,"file":"WidgetSelect.vue_vue_type_script_setup_true_lang-Dy1GD3Fy.js","sources":["../../../../../../ComfyUI_frontend/src/renderer/extensions/vueNodes/widgets/components/WidgetSelectDefault.vue","../../../../../../ComfyUI_frontend/src/renderer/extensions/vueNodes/widgets/components/form/dropdown/FormDropdownInput.vue","../../../../../../ComfyUI_frontend/src/renderer/extensions/vueNodes/widgets/components/form/dropdown/FormDropdownMenuActions.vue","../../../../../../ComfyUI_frontend/src/renderer/extensions/vueNodes/widgets/components/form/dropdown/FormDropdownMenuFilter.vue","../../../../../../ComfyUI_frontend/src/renderer/extensions/vueNodes/widgets/components/form/dropdown/types.ts","../../../../../../ComfyUI_frontend/src/renderer/extensions/vueNodes/widgets/components/form/dropdown/FormDropdownMenuItem.vue","../../../../../../ComfyUI_frontend/src/renderer/extensions/vueNodes/widgets/components/form/dropdown/FormDropdownMenu.vue","../../../../../../ComfyUI_frontend/src/renderer/extensions/vueNodes/widgets/components/form/dropdown/shared.ts","../../../../../../ComfyUI_frontend/src/renderer/extensions/vueNodes/widgets/components/form/dropdown/FormDropdown.vue","../../../../../../ComfyUI_frontend/src/renderer/extensions/vueNodes/widgets/composables/useAssetWidgetData.ts","../../../../../../ComfyUI_frontend/src/renderer/extensions/vueNodes/widgets/components/WidgetSelectDropdown.vue","../../../../../../ComfyUI_frontend/src/renderer/extensions/vueNodes/widgets/components/WidgetSelect.vue"],"sourcesContent":["<template>\n  <WidgetLayoutField :widget>\n    <Select\n      v-model=\"localValue\"\n      :invalid\n      :options=\"selectOptions\"\n      v-bind=\"combinedProps\"\n      :class=\"cn(WidgetInputBaseClass, 'w-full text-xs')\"\n      :aria-label=\"widget.name\"\n      size=\"small\"\n      :pt=\"{\n        option: 'text-xs',\n        dropdown: 'w-8'\n      }\"\n      data-capture-wheel=\"true\"\n      @update:model-value=\"onChange\"\n    />\n  </WidgetLayoutField>\n</template>\n\n<script setup lang=\"ts\">\nimport Select from 'primevue/select'\nimport { computed } from 'vue'\n\nimport { useWidgetValue } from '@/composables/graph/useWidgetValue'\nimport { useTransformCompatOverlayProps } from '@/composables/useTransformCompatOverlayProps'\nimport type { SimplifiedWidget } from '@/types/simplifiedWidget'\nimport { cn } from '@/utils/tailwindUtil'\nimport {\n  PANEL_EXCLUDED_PROPS,\n  filterWidgetProps\n} from '@/utils/widgetPropFilter'\n\nimport { WidgetInputBaseClass } from './layout'\nimport WidgetLayoutField from './layout/WidgetLayoutField.vue'\n\nconst props = defineProps<{\n  widget: SimplifiedWidget<string | number | undefined>\n  modelValue: string | number | undefined\n}>()\n\nconst emit = defineEmits<{\n  'update:modelValue': [value: string | number | undefined]\n}>()\n\n// Use the composable for consistent widget value handling\nconst { localValue, onChange } = useWidgetValue({\n  widget: props.widget,\n  modelValue: props.modelValue,\n  defaultValue: props.widget.options?.values?.[0] || '',\n  emit\n})\n\n// Transform compatibility props for overlay positioning\nconst transformCompatProps = useTransformCompatOverlayProps()\n\n// Extract select options from widget options\nconst selectOptions = computed(() => {\n  const options = props.widget.options\n\n  if (options?.values && Array.isArray(options.values)) {\n    return options.values\n  }\n\n  return []\n})\nconst invalid = computed(\n  () => !!localValue.value && !selectOptions.value.includes(localValue.value)\n)\n\nconst combinedProps = computed(() => ({\n  ...filterWidgetProps(props.widget.options, PANEL_EXCLUDED_PROPS),\n  ...transformCompatProps.value,\n  ...(invalid.value ? { placeholder: `${localValue.value}` } : {})\n}))\n</script>\n","<script setup lang=\"ts\">\nimport { computed } from 'vue'\n\nimport { cn } from '@/utils/tailwindUtil'\n\nimport { WidgetInputBaseClass } from '../../layout'\nimport type { DropdownItem, SelectedKey } from './types'\n\ninterface Props {\n  isOpen?: boolean\n  placeholder?: string\n  files: File[]\n  items: DropdownItem[]\n  selected: Set<SelectedKey>\n  maxSelectable: number\n  uploadable: boolean\n  disabled: boolean\n  accept?: string\n}\n\nconst props = withDefaults(defineProps<Props>(), {\n  isOpen: false,\n  placeholder: 'Select...'\n})\n\nconst emit = defineEmits<{\n  (e: 'select-click', event: MouseEvent): void\n  (e: 'file-change', event: Event): void\n}>()\n\nconst selectedItems = computed(() => {\n  return props.items.filter((item) => props.selected.has(item.id))\n})\n\nconst chevronClass = computed(() =>\n  cn(\n    'mr-2 size-4 transition-transform duration-200 flex-shrink-0 text-component-node-foreground-secondary',\n    {\n      'rotate-180': props.isOpen\n    }\n  )\n)\n\nconst theButtonStyle = computed(() =>\n  cn(\n    'border-0 bg-component-node-widget-background outline-none text-text-secondary',\n    {\n      'hover:bg-component-node-widget-background-hovered cursor-pointer':\n        !props.disabled,\n      'cursor-not-allowed': props.disabled,\n      'text-text-primary': selectedItems.value.length > 0\n    }\n  )\n)\n</script>\n\n<template>\n  <div\n    :class=\"\n      cn(WidgetInputBaseClass, 'flex text-base leading-none', {\n        'opacity-50 cursor-not-allowed !outline-zinc-300/10': disabled\n      })\n    \"\n  >\n    <!-- Dropdown -->\n    <button\n      :class=\"\n        cn(theButtonStyle, 'flex justify-between items-center flex-1 h-8', {\n          'rounded-l-lg': uploadable,\n          'rounded-lg': !uploadable\n        })\n      \"\n      @click=\"emit('select-click', $event)\"\n    >\n      <span class=\"min-w-0 px-4 py-2 text-left\">\n        <span v-if=\"!selectedItems.length\" class=\"min-w-0\">\n          {{ props.placeholder }}\n        </span>\n        <span v-else class=\"line-clamp-1 min-w-0 break-all\">\n          {{ selectedItems.map((item) => item.label ?? item.name).join(', ') }}\n        </span>\n      </span>\n      <i class=\"icon-[lucide--chevron-down]\" :class=\"chevronClass\" />\n    </button>\n    <!-- Open File -->\n    <label\n      v-if=\"uploadable\"\n      :class=\"\n        cn(\n          theButtonStyle,\n          'relative',\n          'size-8 flex justify-center items-center border-l rounded-r-lg border-zinc-300/10'\n        )\n      \"\n    >\n      <i class=\"icon-[lucide--folder-search] size-4\" />\n      <input\n        type=\"file\"\n        class=\"absolute inset-0 -z-1 opacity-0\"\n        :multiple=\"maxSelectable > 1\"\n        :disabled=\"disabled\"\n        :accept=\"accept\"\n        @change=\"emit('file-change', $event)\"\n      />\n    </label>\n  </div>\n</template>\n","<script setup lang=\"ts\">\nimport Popover from 'primevue/popover'\nimport { ref, useTemplateRef } from 'vue'\n\nimport { cn } from '@/utils/tailwindUtil'\n\nimport type { LayoutMode, OptionId, SortOption } from './types'\n\ndefineProps<{\n  isQuerying: boolean\n  sortOptions: SortOption[]\n}>()\n\nconst layoutMode = defineModel<LayoutMode>('layoutMode')\nconst searchQuery = defineModel<string>('searchQuery')\nconst sortSelected = defineModel<OptionId>('sortSelected')\n\nconst actionButtonStyle = cn(\n  'h-8 bg-zinc-500/20 rounded-lg outline outline-1 outline-offset-[-1px] outline-node-component-border transition-all duration-150'\n)\n\nconst resetInputStyle = 'bg-transparent border-0 outline-0 ring-0 text-left'\n\nconst layoutSwitchItemStyle =\n  'size-6 flex justify-center items-center rounded-sm cursor-pointer transition-all duration-150 hover:scale-108 hover:text-base-foreground active:scale-95'\n\nconst sortPopoverRef = useTemplateRef('sortPopoverRef')\nconst sortTriggerRef = useTemplateRef('sortTriggerRef')\nconst isSortPopoverOpen = ref(false)\n\nfunction toggleSortPopover(event: Event) {\n  if (!sortPopoverRef.value || !sortTriggerRef.value) return\n  isSortPopoverOpen.value = !isSortPopoverOpen.value\n  sortPopoverRef.value.toggle(event, sortTriggerRef.value)\n}\nfunction closeSortPopover() {\n  isSortPopoverOpen.value = false\n  sortPopoverRef.value?.hide()\n}\n\nfunction handleSortSelected(item: SortOption) {\n  sortSelected.value = item.id\n  closeSortPopover()\n}\n</script>\n\n<template>\n  <div class=\"text-secondary flex gap-2 px-4\">\n    <!-- TODO: Replace with a common Search input -->\n    <label\n      :class=\"\n        cn(\n          actionButtonStyle,\n          'flex-1 flex px-2 items-center text-base leading-none cursor-text',\n          searchQuery?.trim() !== '' ? 'text-base-foreground' : '',\n          'hover:outline-component-node-widget-background-highlighted/80',\n          'focus-within:outline-component-node-widget-background-highlighted/80'\n        )\n      \"\n    >\n      <i\n        v-if=\"isQuerying\"\n        class=\"mr-2 icon-[lucide--loader-circle] size-4 animate-spin\"\n      />\n      <i v-else class=\"mr-2 icon-[lucide--search] size-4\" />\n      <input\n        v-model=\"searchQuery\"\n        type=\"text\"\n        :class=\"resetInputStyle\"\n        placeholder=\"Search\"\n      />\n    </label>\n\n    <!-- Sort Select -->\n    <button\n      ref=\"sortTriggerRef\"\n      :class=\"\n        cn(\n          resetInputStyle,\n          actionButtonStyle,\n          'relative w-8 flex justify-center items-center cursor-pointer',\n          'hover:outline-component-node-widget-background-highlighted',\n          'active:!scale-95'\n        )\n      \"\n      @click=\"toggleSortPopover\"\n    >\n      <div\n        v-if=\"sortSelected !== 'default'\"\n        class=\"absolute top-[-2px] left-[-2px] size-2 rounded-full bg-component-node-widget-background-highlighted\"\n      />\n      <i class=\"icon-[lucide--arrow-up-down] size-4\" />\n    </button>\n    <!-- Sort Popover -->\n    <Popover\n      ref=\"sortPopoverRef\"\n      :dismissable=\"true\"\n      :close-on-escape=\"true\"\n      unstyled\n      :pt=\"{\n        root: {\n          class: 'absolute z-50'\n        },\n        content: {\n          class: ['bg-transparent border-none p-0 pt-2 rounded-lg shadow-lg']\n        }\n      }\"\n      @hide=\"isSortPopoverOpen = false\"\n    >\n      <div\n        :class=\"\n          cn(\n            'flex flex-col gap-2 p-2 min-w-32',\n            'bg-component-node-background',\n            'rounded-lg outline outline-offset-[-1px] outline-component-node-border'\n          )\n        \"\n      >\n        <button\n          v-for=\"item of sortOptions\"\n          :key=\"item.name\"\n          :class=\"\n            cn(\n              resetInputStyle,\n              'flex justify-between items-center h-6 cursor-pointer',\n              'hover:!text-blue-500'\n            )\n          \"\n          @click=\"handleSortSelected(item)\"\n        >\n          <span>{{ item.name }}</span>\n          <i\n            v-if=\"sortSelected === item.id\"\n            class=\"icon-[lucide--check] size-4\"\n          />\n        </button>\n      </div>\n    </Popover>\n\n    <!-- Layout Switch -->\n    <div\n      :class=\"\n        cn(\n          actionButtonStyle,\n          'flex justify-center items-center p-1 gap-1 hover:outline-component-node-widget-background-highlighted'\n        )\n      \"\n    >\n      <button\n        :class=\"\n          cn(\n            resetInputStyle,\n            layoutSwitchItemStyle,\n            layoutMode === 'list'\n              ? 'bg-neutral-500/50 text-base-foreground'\n              : ''\n          )\n        \"\n        @click=\"layoutMode = 'list'\"\n      >\n        <i class=\"icon-[lucide--list] size-4\" />\n      </button>\n      <button\n        :class=\"\n          cn(\n            resetInputStyle,\n            layoutSwitchItemStyle,\n            layoutMode === 'grid'\n              ? 'bg-neutral-500/50 text-base-foreground'\n              : ''\n          )\n        \"\n        @click=\"layoutMode = 'grid'\"\n      >\n        <i class=\"icon-[lucide--layout-grid] size-4\" />\n      </button>\n    </div>\n  </div>\n</template>\n","<script setup lang=\"ts\">\nimport { cn } from '@/utils/tailwindUtil'\n\nimport type { FilterOption, OptionId } from './types'\n\ndefineProps<{\n  filterOptions: FilterOption[]\n}>()\n\nconst filterSelected = defineModel<OptionId>('filterSelected')\n</script>\n\n<template>\n  <div class=\"text-secondary mb-4 flex gap-1 px-4\">\n    <div\n      v-for=\"option in filterOptions\"\n      :key=\"option.id\"\n      :class=\"\n        cn(\n          'px-4 py-2 rounded-md inline-flex justify-center items-center cursor-pointer select-none',\n          'transition-all duration-150',\n          'hover:text-base-foreground hover:bg-interface-menu-component-surface-hovered',\n          'active:scale-95',\n          filterSelected === option.id\n            ? '!bg-interface-menu-component-surface-selected text-base-foreground'\n            : 'bg-transparent'\n        )\n      \"\n      @click=\"filterSelected = option.id\"\n    >\n      {{ option.name }}\n    </div>\n  </div>\n</template>\n","import type { ComputedRef, InjectionKey } from 'vue'\n\nimport type { AssetKind } from '@/types/widgetTypes'\n\nexport type OptionId = string | number | symbol\nexport type SelectedKey = OptionId\n\nexport interface DropdownItem {\n  id: SelectedKey\n  mediaSrc: string // URL for image, video, or other media\n  name: string\n  label?: string\n  metadata: string\n}\nexport interface SortOption {\n  id: OptionId\n  name: string\n  sorter: (ctx: { items: readonly DropdownItem[] }) => DropdownItem[]\n}\n\nexport interface FilterOption {\n  id: OptionId\n  name: string\n}\n\nexport type LayoutMode = 'list' | 'grid' | 'list-small'\n\nexport const AssetKindKey: InjectionKey<ComputedRef<AssetKind | undefined>> =\n  Symbol('assetKind')\n","<script setup lang=\"ts\">\nimport { computed, inject, ref } from 'vue'\n\nimport LazyImage from '@/components/common/LazyImage.vue'\nimport { cn } from '@/utils/tailwindUtil'\n\nimport { AssetKindKey } from './types'\nimport type { LayoutMode } from './types'\n\ninterface Props {\n  index: number\n  selected: boolean\n  mediaSrc: string\n  name: string\n  label?: string\n  metadata?: string\n  layout?: LayoutMode\n}\n\nconst props = defineProps<Props>()\n\nconst emit = defineEmits<{\n  click: [index: number]\n  mediaLoad: [event: Event]\n}>()\n\nconst actualDimensions = ref<string | null>(null)\n\nconst assetKind = inject(AssetKindKey)\n\nconst isVideo = computed(() => assetKind?.value === 'video')\n\nfunction handleClick() {\n  emit('click', props.index)\n}\n\nfunction handleImageLoad(event: Event) {\n  emit('mediaLoad', event)\n  if (!event.target || !(event.target instanceof HTMLImageElement)) return\n  const img = event.target\n  if (img.naturalWidth && img.naturalHeight) {\n    actualDimensions.value = `${img.naturalWidth} x ${img.naturalHeight}`\n  }\n}\n\nfunction handleVideoLoad(event: Event) {\n  emit('mediaLoad', event)\n  if (!event.target || !(event.target instanceof HTMLVideoElement)) return\n  const video = event.target\n  if (video.videoWidth && video.videoHeight) {\n    actualDimensions.value = `${video.videoWidth} x ${video.videoHeight}`\n  }\n}\n</script>\n\n<template>\n  <div\n    :class=\"\n      cn(\n        'flex gap-1 select-none group/item cursor-pointer bg-component-node-widget-background',\n        'transition-all duration-150',\n        {\n          'flex-col text-center': layout === 'grid',\n          'flex-row text-left max-h-16 rounded-lg hover:scale-102 active:scale-98':\n            layout === 'list',\n          'flex-row text-left hover:bg-component-node-widget-background-hovered rounded-lg':\n            layout === 'list-small',\n          // selection\n          'ring-2 ring-component-node-widget-background-highlighted':\n            layout === 'list' && selected\n        }\n      )\n    \"\n    @click=\"handleClick\"\n  >\n    <!-- Image -->\n    <div\n      v-if=\"layout !== 'list-small'\"\n      :class=\"\n        cn(\n          'relative',\n          'w-full aspect-square overflow-hidden outline-1 outline-offset-[-1px] outline-interface-stroke',\n          'transition-all duration-150',\n          {\n            'min-w-16 max-w-16 rounded-l-lg': layout === 'list',\n            'rounded-sm group-hover/item:scale-108 group-active/item:scale-95':\n              layout === 'grid',\n            // selection\n            'ring-2 ring-component-node-widget-background-highlighted':\n              layout === 'grid' && selected\n          }\n        )\n      \"\n    >\n      <!-- Selected Icon -->\n      <div\n        v-if=\"selected\"\n        class=\"absolute top-1 left-1 size-4 rounded-full border-1 border-base-foreground bg-primary-background\"\n      >\n        <i\n          class=\"icon-[lucide--check] size-3 translate-y-[-0.5px] text-base-foreground bold\"\n        />\n      </div>\n      <video\n        v-if=\"mediaSrc && isVideo\"\n        :src=\"mediaSrc\"\n        class=\"size-full object-cover\"\n        preload=\"metadata\"\n        muted\n        @loadeddata=\"handleVideoLoad\"\n      />\n      <LazyImage\n        v-else-if=\"mediaSrc\"\n        :src=\"mediaSrc\"\n        :alt=\"name\"\n        image-class=\"size-full object-cover\"\n        @load=\"handleImageLoad\"\n      />\n      <div\n        v-else\n        class=\"size-full bg-gradient-to-tr from-blue-400 via-teal-500 to-green-400\"\n      />\n    </div>\n    <!-- Name -->\n    <div\n      :class=\"\n        cn('flex gap-1', {\n          'flex-col': layout === 'grid',\n          'flex-col px-4 py-1 w-full justify-center min-w-0': layout === 'list',\n          'flex-row p-2 items-center justify-between w-full':\n            layout === 'list-small'\n        })\n      \"\n    >\n      <span\n        v-tooltip=\"layout === 'grid' ? (label ?? name) : undefined\"\n        :class=\"\n          cn(\n            'block text-xs line-clamp-2 break-words overflow-hidden',\n            'transition-colors duration-150',\n            // selection\n            !!selected && 'text-base-foreground'\n          )\n        \"\n      >\n        {{ label ?? name }}\n      </span>\n      <!-- Meta Data -->\n      <span class=\"text-secondary block text-xs\">{{\n        metadata || actualDimensions\n      }}</span>\n    </div>\n  </div>\n</template>\n","<script setup lang=\"ts\">\nimport { cn } from '@/utils/tailwindUtil'\n\nimport FormDropdownMenuActions from './FormDropdownMenuActions.vue'\nimport FormDropdownMenuFilter from './FormDropdownMenuFilter.vue'\nimport FormDropdownMenuItem from './FormDropdownMenuItem.vue'\nimport type {\n  DropdownItem,\n  FilterOption,\n  LayoutMode,\n  OptionId,\n  SortOption\n} from './types'\n\ninterface Props {\n  items: DropdownItem[]\n  isSelected: (item: DropdownItem, index: number) => boolean\n  isQuerying: boolean\n  filterOptions: FilterOption[]\n  sortOptions: SortOption[]\n}\n\ndefineProps<Props>()\nconst emit = defineEmits<{\n  (e: 'item-click', item: DropdownItem, index: number): void\n}>()\n\n// Define models for two-way binding\nconst filterSelected = defineModel<OptionId>('filterSelected')\nconst layoutMode = defineModel<LayoutMode>('layoutMode')\nconst sortSelected = defineModel<OptionId>('sortSelected')\nconst searchQuery = defineModel<string>('searchQuery')\n\n// Handle item selection\n</script>\n\n<template>\n  <div\n    class=\"flex max-h-[640px] w-103 flex-col rounded-lg bg-component-node-background pt-4 outline outline-offset-[-1px] outline-node-component-border\"\n  >\n    <!-- Filter -->\n    <FormDropdownMenuFilter\n      v-if=\"filterOptions.length > 0\"\n      v-model:filter-selected=\"filterSelected\"\n      :filter-options=\"filterOptions\"\n    />\n    <!-- Actions -->\n    <FormDropdownMenuActions\n      v-model:layout-mode=\"layoutMode\"\n      v-model:sort-selected=\"sortSelected\"\n      v-model:search-query=\"searchQuery\"\n      :sort-options=\"sortOptions\"\n      :is-querying=\"isQuerying\"\n    />\n    <!-- List -->\n    <div class=\"relative flex h-full mt-2 overflow-y-scroll\">\n      <div\n        :class=\"\n          cn(\n            'h-full max-h-full grid gap-x-2 gap-y-4 overflow-y-auto px-4 pt-4 pb-4 w-full',\n            {\n              'grid-cols-4': layoutMode === 'grid',\n              'grid-cols-1 gap-y-2': layoutMode === 'list',\n              'grid-cols-1 gap-y-1': layoutMode === 'list-small'\n            }\n          )\n        \"\n      >\n        <div class=\"pointer-events-none absolute inset-x-3 top-0 z-10 h-5\" />\n        <div\n          v-if=\"items.length === 0\"\n          class=\"absolute inset-0 flex items-center justify-center\"\n        >\n          <i\n            title=\"No items\"\n            class=\"icon-[lucide--circle-off] size-30 text-zinc-500/20\"\n          />\n        </div>\n        <!-- Item -->\n        <FormDropdownMenuItem\n          v-for=\"(item, index) in items\"\n          :key=\"item.id\"\n          :index=\"index\"\n          :selected=\"isSelected(item, index)\"\n          :media-src=\"item.mediaSrc\"\n          :name=\"item.name\"\n          :label=\"item.label\"\n          :metadata=\"item.metadata\"\n          :layout=\"layoutMode\"\n          @click=\"emit('item-click', item, index)\"\n        />\n      </div>\n    </div>\n  </div>\n</template>\n","import type { DropdownItem, SortOption } from './types'\n\nexport async function defaultSearcher(query: string, items: DropdownItem[]) {\n  if (query.trim() === '') return items\n  const words = query.trim().toLowerCase().split(' ')\n  return items.filter((item) => {\n    const name = item.name.toLowerCase()\n    return words.every((word) => name.includes(word))\n  })\n}\n\nexport function getDefaultSortOptions(): SortOption[] {\n  return [\n    {\n      name: 'Default',\n      id: 'default',\n      sorter: ({ items }) => items.slice()\n    },\n    {\n      name: 'A-Z',\n      id: 'a-z',\n      sorter: ({ items }) =>\n        items.slice().sort((a, b) => {\n          return a.name.localeCompare(b.name)\n        })\n    }\n  ]\n}\n","<script setup lang=\"ts\">\nimport { refDebounced } from '@vueuse/core'\nimport Popover from 'primevue/popover'\nimport { computed, ref, useTemplateRef, watch } from 'vue'\n\nimport { t } from '@/i18n'\nimport { useToastStore } from '@/platform/updates/common/toastStore'\n\nimport FormDropdownInput from './FormDropdownInput.vue'\nimport FormDropdownMenu from './FormDropdownMenu.vue'\nimport { defaultSearcher, getDefaultSortOptions } from './shared'\nimport type {\n  DropdownItem,\n  FilterOption,\n  LayoutMode,\n  OptionId,\n  SelectedKey,\n  SortOption\n} from './types'\n\ninterface Props {\n  items: DropdownItem[]\n  placeholder?: string\n  /**\n   * If true, allows multiple selections. If a number is provided,\n   * it specifies the maximum number of selections allowed.\n   */\n  multiple?: boolean | number\n\n  uploadable?: boolean\n  disabled?: boolean\n  accept?: string\n  filterOptions?: FilterOption[]\n  sortOptions?: SortOption[]\n  isSelected?: (\n    selected: Set<SelectedKey>,\n    item: DropdownItem,\n    index: number\n  ) => boolean\n  searcher?: (\n    query: string,\n    items: DropdownItem[],\n    onCleanup: (cleanupFn: () => void) => void\n  ) => Promise<DropdownItem[]>\n}\n\nconst props = withDefaults(defineProps<Props>(), {\n  placeholder: t('widgets.uploadSelect.placeholder'),\n  multiple: false,\n  uploadable: false,\n  disabled: false,\n  filterOptions: () => [],\n  sortOptions: () => getDefaultSortOptions(),\n  isSelected: (selected, item, _index) => selected.has(item.id),\n  searcher: defaultSearcher\n})\n\nconst selected = defineModel<Set<SelectedKey>>('selected', {\n  default: new Set()\n})\nconst filterSelected = defineModel<OptionId>('filterSelected', { default: '' })\nconst sortSelected = defineModel<OptionId>('sortSelected', {\n  default: 'default'\n})\nconst layoutMode = defineModel<LayoutMode>('layoutMode', {\n  default: 'grid'\n})\nconst files = defineModel<File[]>('files', { default: [] })\nconst searchQuery = defineModel<string>('searchQuery', { default: '' })\n\nconst debouncedSearchQuery = refDebounced(searchQuery, 700, {\n  maxWait: 700\n})\nconst isQuerying = ref(false)\nconst toastStore = useToastStore()\nconst popoverRef = ref<InstanceType<typeof Popover>>()\nconst triggerRef = useTemplateRef('triggerRef')\nconst isOpen = ref(false)\n\nconst maxSelectable = computed(() => {\n  if (props.multiple === true) return Infinity\n  if (typeof props.multiple === 'number') return props.multiple\n  return 1\n})\n\nconst filteredItems = ref<DropdownItem[]>([])\n\nwatch(searchQuery, (value) => {\n  isQuerying.value = value !== debouncedSearchQuery.value\n})\n\nwatch(\n  [debouncedSearchQuery, () => props.items],\n  (_, __, onCleanup) => {\n    let isCleanup = false\n    let cleanupFn: undefined | (() => void)\n    onCleanup(() => {\n      isCleanup = true\n      cleanupFn?.()\n    })\n\n    void props\n      .searcher(\n        debouncedSearchQuery.value,\n        props.items,\n        (cb) => (cleanupFn = cb)\n      )\n      .then((result) => {\n        if (!isCleanup) filteredItems.value = result\n      })\n      .finally(() => {\n        if (!isCleanup) isQuerying.value = false\n      })\n  },\n  { immediate: true }\n)\n\nconst defaultSorter = computed<SortOption['sorter']>(() => {\n  const sorter = props.sortOptions.find(\n    (option) => option.id === 'default'\n  )?.sorter\n  return sorter || (({ items }) => items.slice())\n})\nconst selectedSorter = computed<SortOption['sorter']>(() => {\n  if (sortSelected.value === 'default') return defaultSorter.value\n  const sorter = props.sortOptions.find(\n    (option) => option.id === sortSelected.value\n  )?.sorter\n  return sorter || defaultSorter.value\n})\nconst sortedItems = computed(() => {\n  return selectedSorter.value({ items: filteredItems.value }) || []\n})\n\nfunction internalIsSelected(item: DropdownItem, index: number): boolean {\n  return props.isSelected?.(selected.value, item, index) ?? false\n}\n\nconst toggleDropdown = (event: Event) => {\n  if (props.disabled) return\n  if (popoverRef.value && triggerRef.value) {\n    popoverRef.value.toggle(event, triggerRef.value)\n    isOpen.value = !isOpen.value\n  }\n}\n\nconst closeDropdown = () => {\n  if (popoverRef.value) {\n    popoverRef.value.hide()\n    isOpen.value = false\n  }\n}\n\nfunction handleFileChange(event: Event) {\n  if (props.disabled) return\n  const input = event.target as HTMLInputElement\n  if (input.files) {\n    files.value = Array.from(input.files)\n  }\n  // Clear the input value to allow re-selecting the same file\n  input.value = ''\n}\n\nfunction handleSelection(item: DropdownItem, index: number) {\n  if (props.disabled) return\n  const sel = selected.value\n  if (internalIsSelected(item, index)) {\n    sel.delete(item.id)\n  } else {\n    if (sel.size < maxSelectable.value) {\n      sel.add(item.id)\n    } else if (maxSelectable.value === 1) {\n      sel.clear()\n      sel.add(item.id)\n    } else {\n      toastStore.addAlert(`Maximum selection limit reached`)\n      return\n    }\n  }\n  selected.value = new Set(sel)\n\n  if (maxSelectable.value === 1) {\n    closeDropdown()\n  }\n}\n</script>\n\n<template>\n  <div ref=\"triggerRef\">\n    <FormDropdownInput\n      :files=\"files\"\n      :is-open=\"isOpen\"\n      :placeholder=\"placeholder\"\n      :items=\"items\"\n      :max-selectable=\"maxSelectable\"\n      :selected=\"selected\"\n      :uploadable=\"uploadable\"\n      :disabled=\"disabled\"\n      :accept=\"accept\"\n      @select-click=\"toggleDropdown\"\n      @file-change=\"handleFileChange\"\n    />\n    <Popover\n      ref=\"popoverRef\"\n      :dismissable=\"true\"\n      :close-on-escape=\"true\"\n      unstyled\n      :pt=\"{\n        root: {\n          class: 'absolute z-50'\n        },\n        content: {\n          class: ['bg-transparent border-none p-0 pt-2 rounded-lg shadow-lg']\n        }\n      }\"\n      @hide=\"isOpen = false\"\n    >\n      <FormDropdownMenu\n        v-model:filter-selected=\"filterSelected\"\n        v-model:layout-mode=\"layoutMode\"\n        v-model:sort-selected=\"sortSelected\"\n        v-model:search-query=\"searchQuery\"\n        :filter-options=\"filterOptions\"\n        :sort-options=\"sortOptions\"\n        :disabled=\"disabled\"\n        :is-querying=\"isQuerying\"\n        :items=\"sortedItems\"\n        :is-selected=\"internalIsSelected\"\n        :max-selectable=\"maxSelectable\"\n        @close=\"closeDropdown\"\n        @item-click=\"handleSelection\"\n      />\n    </Popover>\n  </div>\n</template>\n","import { computed, toValue, watch } from 'vue'\nimport type { MaybeRefOrGetter } from 'vue'\n\nimport { isCloud } from '@/platform/distribution/types'\nimport type { AssetItem } from '@/platform/assets/schemas/assetSchema'\nimport type { DropdownItem } from '@/renderer/extensions/vueNodes/widgets/components/form/dropdown/types'\nimport { useAssetsStore } from '@/stores/assetsStore'\nimport { useModelToNodeStore } from '@/stores/modelToNodeStore'\n\n/**\n * Composable for fetching and transforming asset data for Vue node widgets.\n * Provides reactive asset data based on node type with automatic category detection.\n * Uses store-based caching to avoid duplicate fetches across multiple instances.\n *\n * Cloud-only composable - returns empty data when not in cloud environment.\n *\n * @param nodeType - ComfyUI node type (ref, getter, or plain value). Can be undefined.\n *   Accepts: ref('CheckpointLoaderSimple'), () => 'CheckpointLoaderSimple', or 'CheckpointLoaderSimple'\n * @returns Reactive data including category, assets, dropdown items, loading state, and errors\n */\nexport function useAssetWidgetData(\n  nodeType: MaybeRefOrGetter<string | undefined>\n) {\n  if (isCloud) {\n    const assetsStore = useAssetsStore()\n    const modelToNodeStore = useModelToNodeStore()\n\n    const category = computed(() => {\n      const resolvedType = toValue(nodeType)\n      return resolvedType\n        ? modelToNodeStore.getCategoryForNodeType(resolvedType)\n        : undefined\n    })\n\n    const assets = computed<AssetItem[]>(() => {\n      const resolvedType = toValue(nodeType)\n      return resolvedType\n        ? (assetsStore.modelAssetsByNodeType.get(resolvedType) ?? [])\n        : []\n    })\n\n    const isLoading = computed(() => {\n      const resolvedType = toValue(nodeType)\n      return resolvedType\n        ? (assetsStore.modelLoadingByNodeType.get(resolvedType) ?? false)\n        : false\n    })\n\n    const error = computed<Error | null>(() => {\n      const resolvedType = toValue(nodeType)\n      return resolvedType\n        ? (assetsStore.modelErrorByNodeType.get(resolvedType) ?? null)\n        : null\n    })\n\n    const dropdownItems = computed<DropdownItem[]>(() => {\n      return assets.value.map((asset) => ({\n        id: asset.id,\n        name:\n          (asset.user_metadata?.filename as string | undefined) ?? asset.name,\n        label: asset.name,\n        mediaSrc: asset.preview_url ?? '',\n        metadata: ''\n      }))\n    })\n\n    watch(\n      () => toValue(nodeType),\n      async (currentNodeType) => {\n        if (!currentNodeType) {\n          return\n        }\n\n        const hasData = assetsStore.modelAssetsByNodeType.has(currentNodeType)\n\n        if (!hasData) {\n          await assetsStore.updateModelsForNodeType(currentNodeType)\n        }\n      },\n      { immediate: true }\n    )\n\n    return {\n      category,\n      assets,\n      dropdownItems,\n      isLoading,\n      error\n    }\n  }\n\n  return {\n    category: computed(() => undefined),\n    assets: computed(() => []),\n    dropdownItems: computed(() => []),\n    isLoading: computed(() => false),\n    error: computed(() => null)\n  }\n}\n","<script setup lang=\"ts\">\nimport { capitalize } from 'es-toolkit'\nimport { computed, provide, ref, toRef, watch } from 'vue'\n\nimport { useWidgetValue } from '@/composables/graph/useWidgetValue'\nimport { useTransformCompatOverlayProps } from '@/composables/useTransformCompatOverlayProps'\nimport { t } from '@/i18n'\nimport { useToastStore } from '@/platform/updates/common/toastStore'\nimport FormDropdown from '@/renderer/extensions/vueNodes/widgets/components/form/dropdown/FormDropdown.vue'\nimport { AssetKindKey } from '@/renderer/extensions/vueNodes/widgets/components/form/dropdown/types'\nimport type {\n  DropdownItem,\n  FilterOption,\n  LayoutMode,\n  SelectedKey\n} from '@/renderer/extensions/vueNodes/widgets/components/form/dropdown/types'\nimport WidgetLayoutField from '@/renderer/extensions/vueNodes/widgets/components/layout/WidgetLayoutField.vue'\nimport { useAssetWidgetData } from '@/renderer/extensions/vueNodes/widgets/composables/useAssetWidgetData'\nimport type { ResultItemType } from '@/schemas/apiSchema'\nimport { api } from '@/scripts/api'\nimport { useAssetsStore } from '@/stores/assetsStore'\nimport { useQueueStore } from '@/stores/queueStore'\nimport type { SimplifiedWidget } from '@/types/simplifiedWidget'\nimport type { AssetKind } from '@/types/widgetTypes'\nimport {\n  PANEL_EXCLUDED_PROPS,\n  filterWidgetProps\n} from '@/utils/widgetPropFilter'\n\nconst props = defineProps<{\n  widget: SimplifiedWidget<string | number | undefined>\n  modelValue: string | number | undefined\n  nodeType?: string\n  assetKind?: AssetKind\n  allowUpload?: boolean\n  uploadFolder?: ResultItemType\n  isAssetMode?: boolean\n  defaultLayoutMode?: LayoutMode\n}>()\n\nprovide(\n  AssetKindKey,\n  computed(() => props.assetKind)\n)\n\nconst emit = defineEmits<{\n  'update:modelValue': [value: string | number | undefined]\n}>()\n\nconst { localValue, onChange } = useWidgetValue({\n  widget: props.widget,\n  modelValue: () => props.modelValue,\n  defaultValue: props.widget.options?.values?.[0] || '',\n  emit\n})\n\nconst toastStore = useToastStore()\nconst queueStore = useQueueStore()\n\nconst transformCompatProps = useTransformCompatOverlayProps()\n\nconst combinedProps = computed(() => ({\n  ...filterWidgetProps(props.widget.options, PANEL_EXCLUDED_PROPS),\n  ...transformCompatProps.value\n}))\n\nconst getAssetData = () => {\n  if (props.isAssetMode && props.nodeType) {\n    return useAssetWidgetData(toRef(() => props.nodeType))\n  }\n  return null\n}\nconst assetData = getAssetData()\n\nconst filterSelected = ref('all')\nconst filterOptions = computed<FilterOption[]>(() => {\n  if (props.isAssetMode) {\n    const categoryName = assetData?.category.value ?? 'All'\n    return [{ id: 'all', name: capitalize(categoryName) }]\n  }\n  return [\n    { id: 'all', name: 'All' },\n    { id: 'inputs', name: 'Inputs' },\n    { id: 'outputs', name: 'Outputs' }\n  ]\n})\n\nconst selectedSet = ref<Set<SelectedKey>>(new Set())\n\n/**\n * Transforms a value using getOptionLabel if available.\n * Falls back to the original value if getOptionLabel is not provided or throws an error.\n */\nfunction getDisplayLabel(value: string): string {\n  const getOptionLabel = props.widget.options?.getOptionLabel\n  if (!getOptionLabel) return value\n\n  try {\n    return getOptionLabel(value)\n  } catch (e) {\n    console.error('Failed to map value:', e)\n    return value\n  }\n}\n\nconst inputItems = computed<DropdownItem[]>(() => {\n  const values = props.widget.options?.values || []\n\n  if (!Array.isArray(values)) {\n    return []\n  }\n\n  return values.map((value: string, index: number) => ({\n    id: `input-${index}`,\n    mediaSrc: getMediaUrl(value, 'input'),\n    name: value,\n    label: getDisplayLabel(value),\n    metadata: ''\n  }))\n})\nconst outputItems = computed<DropdownItem[]>(() => {\n  if (!['image', 'video'].includes(props.assetKind ?? '')) return []\n\n  const outputs = new Set<string>()\n\n  // Extract output images/videos from queue history\n  queueStore.historyTasks.forEach((task) => {\n    task.flatOutputs.forEach((output) => {\n      const isTargetType =\n        (props.assetKind === 'image' && output.mediaType === 'images') ||\n        (props.assetKind === 'video' && output.mediaType === 'video')\n\n      if (output.type === 'output' && isTargetType) {\n        const path = output.subfolder\n          ? `${output.subfolder}/${output.filename}`\n          : output.filename\n        // Add [output] annotation so the preview component knows the type\n        const annotatedPath = `${path} [output]`\n        outputs.add(annotatedPath)\n      }\n    })\n  })\n\n  return Array.from(outputs).map((output, index) => ({\n    id: `output-${index}`,\n    mediaSrc: getMediaUrl(output.replace(' [output]', ''), 'output'),\n    name: output,\n    label: getDisplayLabel(output),\n    metadata: ''\n  }))\n})\n\nconst allItems = computed<DropdownItem[]>(() => {\n  if (props.isAssetMode && assetData) {\n    return assetData.dropdownItems.value\n  }\n  return [...inputItems.value, ...outputItems.value]\n})\nconst dropdownItems = computed<DropdownItem[]>(() => {\n  if (props.isAssetMode) {\n    return allItems.value\n  }\n\n  switch (filterSelected.value) {\n    case 'inputs':\n      return inputItems.value\n    case 'outputs':\n      return outputItems.value\n    case 'all':\n    default:\n      return allItems.value\n  }\n})\n\nconst mediaPlaceholder = computed(() => {\n  const options = props.widget.options\n\n  if (options?.placeholder) {\n    return options.placeholder\n  }\n\n  switch (props.assetKind) {\n    case 'image':\n      return t('widgets.uploadSelect.placeholderImage')\n    case 'video':\n      return t('widgets.uploadSelect.placeholderVideo')\n    case 'audio':\n      return t('widgets.uploadSelect.placeholderAudio')\n    case 'model':\n      return t('widgets.uploadSelect.placeholderModel')\n    case 'unknown':\n      return t('widgets.uploadSelect.placeholderUnknown')\n  }\n\n  return t('widgets.uploadSelect.placeholder')\n})\n\nconst uploadable = computed(() => {\n  if (props.isAssetMode) return false\n  return props.allowUpload === true\n})\n\nconst acceptTypes = computed(() => {\n  // Be permissive with accept types because backend uses libraries\n  // that can handle a wide range of formats\n  switch (props.assetKind) {\n    case 'image':\n      return 'image/*'\n    case 'video':\n      return 'video/*'\n    case 'audio':\n      return 'audio/*'\n    default:\n      return undefined // model or unknown\n  }\n})\n\nconst layoutMode = ref<LayoutMode>(props.defaultLayoutMode ?? 'grid')\n\nwatch(\n  localValue,\n  (currentValue) => {\n    if (currentValue !== undefined) {\n      const item = dropdownItems.value.find(\n        (item) => item.name === currentValue\n      )\n      if (item) {\n        selectedSet.value.clear()\n        selectedSet.value.add(item.id)\n      }\n    } else {\n      selectedSet.value.clear()\n    }\n  },\n  { immediate: true }\n)\n\nfunction updateSelectedItems(selectedItems: Set<SelectedKey>) {\n  let id: SelectedKey | undefined = undefined\n  if (selectedItems.size > 0) {\n    id = selectedItems.values().next().value!\n  }\n  if (id == null) {\n    onChange(undefined)\n    return\n  }\n  const name = dropdownItems.value.find((item) => item.id === id)?.name\n  if (!name) {\n    onChange(undefined)\n    return\n  }\n  onChange(name)\n}\n\n// Upload file function (copied from useNodeImageUpload.ts)\nconst uploadFile = async (\n  file: File,\n  isPasted: boolean = false,\n  formFields: Partial<{ type: ResultItemType }> = {}\n) => {\n  const body = new FormData()\n  body.append('image', file)\n  if (isPasted) body.append('subfolder', 'pasted')\n  if (formFields.type) body.append('type', formFields.type)\n\n  const resp = await api.fetchApi('/upload/image', {\n    method: 'POST',\n    body\n  })\n\n  if (resp.status !== 200) {\n    toastStore.addAlert(resp.status + ' - ' + resp.statusText)\n    return null\n  }\n\n  const data = await resp.json()\n\n  // Update AssetsStore when uploading to input folder\n  if (formFields.type === 'input' || (!formFields.type && !isPasted)) {\n    const assetsStore = useAssetsStore()\n    await assetsStore.updateInputs()\n  }\n\n  return data.subfolder ? `${data.subfolder}/${data.name}` : data.name\n}\n\n// Handle multiple file uploads\nconst uploadFiles = async (files: File[]): Promise<string[]> => {\n  const folder = props.uploadFolder ?? 'input'\n  const uploadPromises = files.map((file) =>\n    uploadFile(file, false, { type: folder })\n  )\n  const results = await Promise.all(uploadPromises)\n  return results.filter((path): path is string => path !== null)\n}\n\nasync function handleFilesUpdate(files: File[]) {\n  if (!files || files.length === 0) return\n\n  try {\n    // 1. Upload files to server\n    const uploadedPaths = await uploadFiles(files)\n\n    if (uploadedPaths.length === 0) {\n      toastStore.addAlert('File upload failed')\n      return\n    }\n\n    // 2. Update widget options to include new files\n    // This simulates what addToComboValues does but for SimplifiedWidget\n    if (props.widget.options?.values) {\n      uploadedPaths.forEach((path) => {\n        const values = props.widget.options!.values as string[]\n        if (!values.includes(path)) {\n          values.push(path)\n        }\n      })\n    }\n\n    // 3. Update widget value to the first uploaded file\n    onChange(uploadedPaths[0])\n\n    // 4. Trigger callback to notify underlying LiteGraph widget\n    if (props.widget.callback) {\n      props.widget.callback(uploadedPaths[0])\n    }\n  } catch (error) {\n    console.error('Upload error:', error)\n    toastStore.addAlert(`Upload failed: ${error}`)\n  }\n}\n\nfunction getMediaUrl(\n  filename: string,\n  type: 'input' | 'output' = 'input'\n): string {\n  if (!['image', 'video'].includes(props.assetKind ?? '')) return ''\n  return `/api/view?filename=${encodeURIComponent(filename)}&type=${type}`\n}\n</script>\n\n<template>\n  <WidgetLayoutField :widget>\n    <FormDropdown\n      v-model:selected=\"selectedSet\"\n      v-model:filter-selected=\"filterSelected\"\n      v-model:layout-mode=\"layoutMode\"\n      :items=\"dropdownItems\"\n      :placeholder=\"mediaPlaceholder\"\n      :multiple=\"false\"\n      :uploadable=\"uploadable\"\n      :accept=\"acceptTypes\"\n      :filter-options=\"filterOptions\"\n      v-bind=\"combinedProps\"\n      class=\"w-full\"\n      @update:selected=\"updateSelectedItems\"\n      @update:files=\"handleFilesUpdate\"\n    />\n  </WidgetLayoutField>\n</template>\n","<template>\n  <WidgetSelectDropdown\n    v-if=\"isDropdownUIWidget\"\n    v-bind=\"props\"\n    :asset-kind=\"assetKind\"\n    :allow-upload=\"allowUpload\"\n    :upload-folder=\"uploadFolder\"\n    :is-asset-mode=\"isAssetMode\"\n    :default-layout-mode=\"defaultLayoutMode\"\n    @update:model-value=\"handleUpdateModelValue\"\n  />\n  <WidgetSelectDefault\n    v-else\n    :widget=\"widget\"\n    :model-value=\"modelValue\"\n    @update:model-value=\"handleUpdateModelValue\"\n  />\n</template>\n\n<script setup lang=\"ts\">\nimport { computed } from 'vue'\n\nimport { assetService } from '@/platform/assets/services/assetService'\nimport { isCloud } from '@/platform/distribution/types'\nimport { useSettingStore } from '@/platform/settings/settingStore'\nimport WidgetSelectDefault from '@/renderer/extensions/vueNodes/widgets/components/WidgetSelectDefault.vue'\nimport WidgetSelectDropdown from '@/renderer/extensions/vueNodes/widgets/components/WidgetSelectDropdown.vue'\nimport type { LayoutMode } from '@/renderer/extensions/vueNodes/widgets/components/form/dropdown/types'\nimport type { ResultItemType } from '@/schemas/apiSchema'\nimport { isComboInputSpec } from '@/schemas/nodeDef/nodeDefSchemaV2'\nimport type { ComboInputSpec } from '@/schemas/nodeDef/nodeDefSchemaV2'\nimport type { SimplifiedWidget } from '@/types/simplifiedWidget'\nimport type { AssetKind } from '@/types/widgetTypes'\n\nconst props = defineProps<{\n  widget: SimplifiedWidget<string | number | undefined>\n  modelValue: string | number | undefined\n  nodeType?: string\n}>()\n\nconst emit = defineEmits<{\n  'update:modelValue': [value: string | number | undefined]\n}>()\n\nfunction handleUpdateModelValue(value: string | number | undefined) {\n  emit('update:modelValue', value)\n}\n\nconst comboSpec = computed<ComboInputSpec | undefined>(() => {\n  if (props.widget.spec && isComboInputSpec(props.widget.spec)) {\n    return props.widget.spec\n  }\n  return undefined\n})\n\nconst specDescriptor = computed<{\n  kind: AssetKind\n  allowUpload: boolean\n  folder: ResultItemType | undefined\n}>(() => {\n  const spec = comboSpec.value\n  if (!spec) {\n    return {\n      kind: 'unknown',\n      allowUpload: false,\n      folder: undefined\n    }\n  }\n\n  const {\n    image_upload,\n    animated_image_upload,\n    video_upload,\n    image_folder,\n    audio_upload\n  } = spec\n\n  let kind: AssetKind = 'unknown'\n  if (video_upload) {\n    kind = 'video'\n  } else if (image_upload || animated_image_upload) {\n    kind = 'image'\n  } else if (audio_upload) {\n    kind = 'audio'\n  }\n  // TODO: add support for models (checkpoints, VAE, LoRAs, etc.) -- get widgetType from spec\n\n  const allowUpload =\n    image_upload === true ||\n    animated_image_upload === true ||\n    video_upload === true ||\n    audio_upload === true\n  return {\n    kind,\n    allowUpload,\n    folder: image_folder\n  }\n})\n\nconst isAssetMode = computed(() => {\n  if (isCloud) {\n    const settingStore = useSettingStore()\n    const isUsingAssetAPI = settingStore.get('Comfy.Assets.UseAssetAPI')\n    const isEligible = assetService.isAssetBrowserEligible(\n      props.nodeType,\n      props.widget.name\n    )\n\n    return isUsingAssetAPI && isEligible\n  }\n\n  return false\n})\n\nconst assetKind = computed(() => specDescriptor.value.kind)\nconst isDropdownUIWidget = computed(\n  () => isAssetMode.value || assetKind.value !== 'unknown'\n)\nconst allowUpload = computed(() => specDescriptor.value.allowUpload)\nconst uploadFolder = computed<ResultItemType>(() => {\n  return specDescriptor.value.folder ?? 'input'\n})\nconst defaultLayoutMode = computed<LayoutMode>(() => {\n  return isAssetMode.value ? 'list' : 'grid'\n})\n</script>\n"],"names":["props","__props","emit","__emit","localValue","onChange","useWidgetValue","transformCompatProps","useTransformCompatOverlayProps","selectOptions","computed","options","invalid","combinedProps","filterWidgetProps","PANEL_EXCLUDED_PROPS","selectedItems","item","chevronClass","cn","theButtonStyle","resetInputStyle","layoutSwitchItemStyle","layoutMode","_useModel","searchQuery","sortSelected","actionButtonStyle","sortPopoverRef","useTemplateRef","sortTriggerRef","isSortPopoverOpen","ref","toggleSortPopover","event","__name","closeSortPopover","handleSortSelected","filterSelected","AssetKindKey","actualDimensions","assetKind","inject","isVideo","handleClick","handleImageLoad","img","handleVideoLoad","video","defaultSearcher","query","items","words","name","word","getDefaultSortOptions","a","b","selected","files","debouncedSearchQuery","refDebounced","isQuerying","toastStore","useToastStore","popoverRef","triggerRef","isOpen","maxSelectable","filteredItems","watch","value","_","__","onCleanup","isCleanup","cleanupFn","cb","result","defaultSorter","option","selectedSorter","sortedItems","internalIsSelected","index","toggleDropdown","closeDropdown","handleFileChange","input","handleSelection","sel","useAssetWidgetData","nodeType","provide","queueStore","useQueueStore","assetData","toRef","filterOptions","categoryName","capitalize","selectedSet","getDisplayLabel","getOptionLabel","e","inputItems","values","getMediaUrl","outputItems","outputs","task","output","isTargetType","annotatedPath","allItems","dropdownItems","mediaPlaceholder","t","uploadable","acceptTypes","currentValue","updateSelectedItems","id","uploadFile","file","isPasted","formFields","body","resp","api","data","useAssetsStore","uploadFiles","folder","uploadPromises","path","handleFilesUpdate","uploadedPaths","error","filename","type","handleUpdateModelValue","comboSpec","isComboInputSpec","specDescriptor","spec","image_upload","animated_image_upload","video_upload","image_folder","audio_upload","kind","isAssetMode","isDropdownUIWidget","allowUpload","uploadFolder","defaultLayoutMode"],"mappings":"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"}